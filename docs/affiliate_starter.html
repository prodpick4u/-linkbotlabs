<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Prodpick4U Affiliate Starter Page</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap">
<style>
body {
  font-family:'Inter',sans-serif;
  margin:0; padding:2rem;
  color:#fff;
  background: linear-gradient(-45deg,#0a0033,#3b007f,#1a1aff,#6f00ff);
  background-size: 400% 400%;
  animation: gradientShift 15s ease infinite;
}
@keyframes gradientShift {
  0%{background-position:0% 50%;}
  25%{background-position:50% 50%;}
  50%{background-position:100% 50%;}
  75%{background-position:50% 50%;}
  100%{background-position:0% 50%;}
}
h1,h2,h3,h4 { color:#9cf; }
h1 { text-align:center; font-size:2.5rem; margin-bottom:1rem; }
p { line-height:1.5; }
.glass {
  background: rgba(0,0,0,0.5);
  backdrop-filter: blur(10px);
  border-radius:12px;
  padding:20px;
  margin-bottom:2rem;
}
input, button, select {
  width:100%;
  padding:10px;
  margin:6px 0;
  border-radius:5px;
  border:none;
}
input, select { background: rgba(20,20,20,0.7); color:#fff; }
button {
  background: linear-gradient(135deg,#6a11cb,#2575fc);
  color:#fff;
  font-weight:bold;
  cursor:pointer;
}
button:hover { opacity:0.85; }
.output { background:rgba(0,0,0,0.7); padding:15px; border-radius:8px; margin-top:15px; color:#0f0; white-space:pre-wrap; }
.section-title { font-size:1.5rem; margin-bottom:1rem; text-align:center; }
.chat-box { background: rgba(0,0,0,0.6); padding:15px; border-radius:8px; max-height:300px; overflow-y:auto; margin-bottom:10px; }
.chat-input { display:flex; gap:5px; }
.chat-input input { flex:1; }
.timer { text-align:center; font-size:1rem; margin-bottom:1rem; color:#ff0; }

/* Collapsible styles */
.collapsible {
  background-color: rgba(0,0,0,0.5);
  color: #fff;
  cursor: pointer;
  padding: 12px;
  width: 100%;
  border: none;
  text-align: left;
  outline: none;
  font-size: 1.1rem;
  border-radius:8px;
  margin-bottom:6px;
}
.collapsible.active { background-color: rgba(75,0,150,0.7); }
.content {
  padding: 0 15px;
  max-height: 0;
  overflow: hidden;
  transition: max-height 0.3s ease;
  background-color: rgba(0,0,0,0.3);
  border-radius: 8px;
  margin-bottom: 10px;
}
.blog-post { background: rgba(20,20,20,0.6); padding:10px; border-radius:6px; margin-top:10px; color:#fff; }
</style>
</head>
<body>

<h1>üöÄ Prodpick4U Affiliate Starter Page</h1>
<p style="text-align:center;">View all products with our default affiliate links. Authorized users can replace links with their own using a secure code.</p>

<div class="glass">
<h2 class="section-title">üí° Rent This Space</h2>
<p>Rent this space with your own affiliate tag automatically included, or purchase the full product and get a 1-week free demo.</p>
</div>

<div id="demoTimer" class="timer"></div>

<!-- Password Section -->
<div class="glass">
<h2 class="section-title">üîí Affiliate Access</h2>
<p>Enter the password provided by the developer to activate your affiliate links.</p>
<input type="password" id="demoPassword" placeholder="Enter access code">
<button onclick="checkPassword()">Unlock Affiliate Form</button>
<div id="passwordOutput" class="output"></div>
</div>

<!-- Affiliate Form (hidden until password correct) -->
<div id="affiliateFormSection" style="display:none;" class="glass">
<h2 class="section-title">üìù Register Your Affiliate Tag</h2>
<form id="affiliateForm">
<label>Your Amazon Affiliate Tag:
  <input id="userAffiliate" type="text" placeholder="mytag-20" required>
</label>
<button type="submit">Activate Demo</button>
</form>
<div id="regOutput" class="output"></div>
</div>

<!-- Product Categories -->
<div class="glass">
<h2 class="section-title">üóùÔ∏è Products & Blogs ‚Äì Default Fallback</h2>
<div id="productOutput" class="output"></div>
</div>

<!-- AI Q&A Bot -->
<div class="glass">
<h2 class="section-title">ü§ñ Ask the Bot</h2>
<div id="chatBox" class="chat-box"></div>
<div class="chat-input">
<input type="text" id="chatInput" placeholder="Ask about the tool, API keys, or workflow...">
<button onclick="askBot()">Send</button>
</div>
</div>

<script>
// ==========================
// Demo Password
// ==========================
const DEMO_PASSWORD = "starter123"; 

function checkPassword() {
  const input = document.getElementById('demoPassword').value.trim();
  const output = document.getElementById('passwordOutput');
  if(input === DEMO_PASSWORD){
    output.innerHTML = "‚úÖ Access granted! Enter your affiliate tag below.";
    document.getElementById('affiliateFormSection').style.display = 'block';
  } else {
    output.innerHTML = "‚ùå Incorrect code. Affiliate form is locked.";
  }
}

// ==========================
// Fallback Products & Blogs
// ==========================
const FALLBACK_PRODUCTS = {
  "health":[
    {title:"Fitbit Charge 5", url:"https://www.amazon.com/dp/B0DGPQKF2W?tag=mychanneld-20", price:"$129.95", description:"Fitness tracker with built-in GPS."},
    {title:"Theragun Elite", url:"https://amzn.to/3Hm7HiH", price:"$299.00", description:"Percussive therapy device."},
    {title:"Methylene Blue", url:"https://amzn.to/4ldkJwL", price:"Varies", description:"Supplement for cognitive function."},
    {title:"Irish Sea Moss", url:"https://www.amazon.com/dp/B0CTMJYZ73?tag=mychanneld-20", price:"Varies", description:"Rich in minerals for immune support."},
    {title:"Shilajit", url:"https://amzn.to/4li6vuC", price:"Varies", description:"Boosts energy and vitality."}
  ],
  "beauty":[
    {title:"Revlon One-Step Hair Dryer", url:"https://amzn.to/40SbniQ", price:"$59.99", description:"Hair styling tool."},
    {title:"Olay Regenerist Cream", url:"https://amzn.to/41r3Ibr", price:"$25.99", description:"Anti-aging moisturizer."},
    {title:"Neutrogena Makeup Remover", url:"https://amzn.to/40OFPdO", price:"$9.99", description:"Gentle makeup wipes."},
    {title:"Maybelline Mascara", url:"https://amzn.to/4opz1NO", price:"$7.99", description:"Volumizing mascara."},
    {title:"CeraVe Facial Cleanser", url:"https://amzn.to/3J34u8n", price:"$14.99", description:"Gentle cleanser for normal to dry skin."}
  ],
  "kitchen":[
    {title:"Instant Pot Duo", url:"https://amzn.to/4oD8b50", price:"$89.00", description:"Multi-functional pressure cooker."},
    {title:"Lodge Cast Iron Skillet", url:"https://amzn.to/47igIUx", price:"$24.99", description:"Durable cast iron pan."},
    {title:"Breville Smart Oven Air Fryer", url:"https://amzn.to/45lPvxL", price:"$279.95", description:"Countertop convection oven."},
    {title:"KitchenAid Stand Mixer", url:"https://amzn.to/45lPCJH", price:"$379.99", description:"Versatile mixer."},
    {title:"Cuisinart Food Processor", url:"https://amzn.to/3UgiUEs", price:"$149.95", description:"Chopping and slicing processor."}
  ],
  "tech":[
    {title:"Apple AirPods Pro", url:"https://amzn.to/3UAYMx7", price:"$249.00", description:"Premium ANC earbuds."},
    {title:"Samsung Galaxy Buds FE", url:"https://amzn.to/4m6BhIh", price:"$99.99", description:"Balanced audio earbuds."},
    {title:"Anker Soundcore P20i", url:"https://amzn.to/4mqytoV", price:"$29.99", description:"Budget wireless earbuds."}
  ],
  "outdoors":[
    {title:"Coleman Sundome Tent", url:"https://amzn.to/4myC9oX", price:"$99.99", description:"Camping tent."},
    {title:"LifeStraw Personal Water Filter", url:"https://amzn.to/4m3CoIw", price:"$19.97", description:"Portable water purifier."}
  ],
  "household":[
    {title:"iRobot Roomba 694", url:"https://amzn.to/4flpTp8", price:"$249.99", description:"Smart robot vacuum."},
    {title:"Dyson V8 Absolute", url:"https://amzn.to/4fll1QY", price:"$399.99", description:"Cordless vacuum cleaner."}
  ],
  "home-decor":[
    {title:"Amethyst Crystal Tree", url:"https://www.amazon.com/dp/B0B8QWN9NT?tag=mychanneld-20", price:"$39.95", description:"Handcrafted crystal tree."},
    {title:"Linon Sherpa Office Chair", url:"https://www.amazon.com/dp/B083TRV28M?tag=mychanneld-20", price:"$129.99", description:"Plush office chair."}
  ]
};

const BLOG_POSTS = {
  "health": `<h4>Top Health Tips for 2025</h4><p>Stay fit with daily routines, supplements, and mindful nutrition.</p>`,
  "beauty": `<h4>Beauty Essentials</h4><p>Discover must-have beauty tools and skincare products for daily care.</p>`,
  "kitchen": `<h4>Upgrade Your Kitchen</h4><p>From Instant Pots to Breville Air Fryers, make your kitchen smarter.</p>`,
  "tech": `<h4>Latest Tech Gadgets</h4><p>AirPods Pro, Samsung Galaxy Buds FE, and other top gadgets.</p>`,
  "outdoors": `<h4>Outdoor Adventures</h4><p>Stay prepared with Coleman tents, LifeStraw filters, and gear for your trips.</p>`,
  "household": `<h4>Smart Home & Cleaning</h4><p>Keep your home spotless with Roombas, Dyson vacuum cleaners, and more.</p>`,
  "home-decor": `<h4>Home Decor Ideas</h4><p>Add elegance to your space with amethyst trees and stylish chairs.</p>`
};

// ==========================
// TTS + SEO
// ==========================
let synth = window.speechSynthesis;
let utter; let typingInterval;

function generateSEOReview(name, keyword){
  return `${name} is a top-quality product for anyone looking for ${keyword}. Reliable, efficient, and premium quality. Perfect for daily use or gifting. Enhance your lifestyle today with ${name}.`;
}

function playTTS(text, spanId){
  stopTTS();
  utter = new SpeechSynthesisUtterance(text);
  const voices = synth.getVoices();
  utter.voice = voices.find(v=>v.name.includes("Samantha"))||voices[0];
  synth.speak(utter);
  startTyping(text, spanId);
}

function stopTTS(){ if(synth.speaking) synth.cancel(); clearInterval(typingInterval); }

function startTyping(text, spanId){ clearInterval(typingInterval); const span=document.getElementById(spanId); let i=0; span.textContent=''; typingInterval=setInterval(()=>{ if(i<text.length){ span.textContent+=text.charAt(i); i++; } else clearInterval(typingInterval); },25); }

// ==========================
// Render Categories
// ==========================
let userAffiliateTag = "";

function renderCategories(expandAll=false){
  let html = "";
  Object.keys(FALLBACK_PRODUCTS).forEach(cat => {
    let blogHTML = BLOG_POSTS[cat] || "<i>No blog content available</i>";
    html += `
      <button class="collapsible ${expandAll?'active':''}">üìÇ ${cat.charAt(0).toUpperCase() + cat.slice(1)}</button>
      <div class="content" style="max-height:${expandAll?'none':'0'};">
        <button onclick="playAllTTS('${cat}')">üîä Play All TTS</button>
        ${FALLBACK_PRODUCTS[cat].map((p,i)=>{
          let url = userAffiliateTag ? p.url.replace(/tag=[^&]+/, `tag=${userAffiliateTag}`) : p.url;
          const review = generateSEOReview(p.title, cat);
          return `
            üõí <a href="${url}" target="_blank">${p.title} (${p.price})</a><br>
            üìù SEO Review: <span id="review_${cat}_${i}"></span><br>
            <button onclick="playTTS('${review}','review_${cat}_${i}')">üîä Play TTS</button>
            <button onclick="stopTTS()">‚èπ Stop TTS</button>
            <hr>
          `;
        }).join('')}
        <h3>üìù Daily Blog</h3>
        <div class="blog-post">${blogHTML}</div>
      </div>
    `;
  });
  document.getElementById('productOutput').innerHTML = html;

  const collapsibles = document.getElementsByClassName("collapsible");
  Array.from(collapsibles).forEach(btn => {
    btn.addEventListener("click", function() {
      this.classList.toggle("active");
      const content = this.nextElementSibling;
      content.style.maxHeight = content.style.maxHeight ? null : content.scrollHeight + "px";
    });
  });
}

// ==========================
// Play All TTS
// ==========================
async function playAllTTS(cat){
  stopTTS();
  const products = FALLBACK_PRODUCTS[cat];
  for(let i=0; i<products.length; i++){
    const review = generateSEOReview(products[i].title, cat);
    const spanId = `review_${cat}_${i}`;
    document.getElementById(spanId).parentElement.parentElement.style.maxHeight = document.getElementById(spanId).parentElement.parentElement.scrollHeight + "px";
    await speakAsync(review, spanId);
    await delay(500);
  }
}

function speakAsync(text, spanId){
  return new Promise(resolve=>{
    const utterThis = new SpeechSynthesisUtterance(text);
    const voices = synth.getVoices();
    utterThis.voice = voices.find(v=>v.name.includes("Samantha"))||voices[0];
    utterThis.onend = resolve;
    synth.speak(utterThis);
    startTyping(text, spanId);
  });
}

function delay(ms){ return new Promise(resolve=>setTimeout(resolve, ms)); }

// ==========================
// Affiliate Form
// ==========================
document.getElementById('affiliateForm').addEventListener('submit', e=>{
  e.preventDefault();
  userAffiliateTag = document.getElementById('userAffiliate').value.trim();
  if(!userAffiliateTag){ alert("Enter a valid tag."); return; }
  document.getElementById('regOutput').innerHTML = `‚úÖ Affiliate tag <b>${userAffiliateTag}</b> activated. All product links updated! Your 1-week demo starts now.`;
  startDemoTimer(7); 
  renderCategories(true); 
});

// ==========================
// Demo Timer
// ==========================
function startDemoTimer(days){
  const endTime = new Date().getTime() + days*24*60*60*1000;
  const timerDiv = document.getElementById('demoTimer');
  const interval = setInterval(()=>{
    const now = new Date().getTime();
    const distance = endTime - now;
    if(distance <= 0){
      clearInterval(interval);
      timerDiv.textContent = "‚è∞ Demo expired. Please register again to continue.";
      return;
    }
    const d = Math.floor(distance/(1000*60*60*24));
    const h = Math.floor((distance%(1000*60*60*24))/(1000*60*60));
    const m = Math.floor((distance%(1000*60*60))/(1000*60));
    const s = Math.floor((distance%(1000*60))/1000);
    timerDiv.textContent = `‚è≥ Your demo expires in ${d}d ${h}h ${m}m ${s}s`;
  },1000);
}

// ==========================
// AI Bot
// ==========================
function askBot(){
  const input = document.getElementById('chatInput').value.trim();
  if(!input) return;
  const chatBox = document.getElementById('
