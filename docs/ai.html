<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>AI Playground (Updated)</title>
<script src="https://js.puter.com/v2/"></script>
<style>
:root {
  --glass: rgba(0,0,0,0.35);
  --stroke: rgba(255,255,255,0.12);
  --text:#fff;
  --muted:#cfcfcf;
  --accent:#ffe169;
}
* { box-sizing: border-box; }
html, body { height: 100%; }
body {
  margin: 0; padding: 24px; color: var(--text);
  background: radial-gradient(1200px 1200px at 10% -10%, #111 0%, #000 60%, #000 100%);
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Inter, Arial, sans-serif;
}
h1 { margin:0 0 18px 0; font-weight:700; letter-spacing:.2px; }
.grid { display:grid; grid-template-columns: repeat(12,1fr); gap:18px; }
.card {
  grid-column: span 12; background: var(--glass); border:1px solid var(--stroke);
  border-radius:14px; padding:16px; backdrop-filter:blur(10px); -webkit-backdrop-filter:blur(10px);
  box-shadow:0 10px 30px rgba(0,0,0,.35);
}
@media (min-width:900px) { .card { grid-column: span 6; } }
label { display:block; font-size:12px; color: var(--muted); margin:8px 0 6px; }
textarea, input, select {
  width:100%; color:var(--text); background: rgba(255,255,255,0.06);
  border:1px solid var(--stroke); border-radius:10px; padding:10px 12px; outline:none; caret-color:var(--text);
}
textarea { min-height:84px; resize:vertical; }
button {
  display:inline-flex; align-items:center; gap:8px;
  background:var(--accent); color:#000; font-weight:700; border:0;
  border-radius:10px; padding:10px 14px; cursor:pointer; margin-top:10px;
}
.output {
  margin-top:12px; padding:12px; border-radius:10px;
  background: rgba(255,255,255,0.04); border:1px solid var(--stroke);
  white-space: pre-wrap; word-wrap: break-word;
}
img.gen { max-width:100%; height:auto; display:block; border-radius:10px; margin-top:10px; }
.hint { font-size:12px; color: var(--muted); margin-top:6px; }
</style>
</head>
<body>
<h1>AI Playground (Updated)</h1>
<div class="grid">

<!-- CHAT / Q&A -->
<div class="card" id="card-chat">
  <h2>Chat / Q&A</h2>
  <div class="hint">Ask anything. Choose a chat model (includes GPT-4.1-nano).</div>
  <label for="chat-model">Model</label>
  <select id="chat-model">
    <option value="gpt-4.1-nano" selected>GPT-4.1-nano</option>
    <option value="gpt-4o">GPT-4o</option>
    <option value="gpt-5">GPT-5</option>
    <option value="claude-sonnet-4">Claude Sonnet 4</option>
  </select>
  <label for="chat-prompt">Prompt</label>
  <textarea id="chat-prompt" placeholder="Explain quantum computing in simple terms"></textarea>
  <button id="chat-run">Run</button>
  <div class="output" id="chat-out"></div>
</div>

<!-- IMAGE GENERATION -->
<div class="card" id="card-imggen">
  <h2>Image Generation</h2>
  <div class="hint">Generate images from text (DALL·E via Puter.js).</div>
  <label for="imggen-prompt">Image Prompt</label>
  <textarea id="imggen-prompt" placeholder="A futuristic city at night"></textarea>
  <label for="imggen-count">Number of Images</label>
  <select id="imggen-count">
    <option value="1">1</option>
    <option value="2" selected>2</option>
    <option value="3">3</option>
  </select>
  <button id="imggen-run">Generate</button>
  <div class="output" id="imggen-out"></div>
</div>

</div>

<script>
/* ---------- Helpers ---------- */
function putText(el, text) { el.innerHTML = (text ?? '').toString(); }
function appendText(el, text) { el.innerHTML += (text ?? '').toString(); }
function normalize(resp) {
  if (!resp) return '';
  if (typeof resp === 'string') return resp;
  if (resp.output_text) return resp.output_text;
  if (resp.text) return resp.text;
  if (resp.message?.content) {
    const flatten = (obj) => {
      if (!obj) return '';
      if (typeof obj === 'string') return obj;
      if (Array.isArray(obj)) return obj.map(flatten).join('\n');
      if (typeof obj === 'object') return Object.values(obj).map(flatten).join('\n');
      return obj.toString();
    };
    return flatten(resp.message.content);
  }
  return JSON.stringify(resp, null, 2);
}

/* ---------- CHAT ---------- */
document.getElementById('chat-run').addEventListener('click', async () => {
  const model = document.getElementById('chat-model').value;
  const prompt = document.getElementById('chat-prompt').value.trim();
  const out = document.getElementById('chat-out');
  if (!prompt) { putText(out, 'Please enter a prompt.'); return; }
  putText(out, 'Thinking…');
  try {
    const resp = await puter.ai.chat(prompt, { model });
    putText(out, normalize(resp));
  } catch (e) { putText(out, 'Error: ' + (e?.message ?? e)); }
});

/* ---------- IMAGE GENERATION ---------- */
document.getElementById('imggen-run').addEventListener('click', async () => {
  const prompt = document.getElementById('imggen-prompt').value.trim();
  const out = document.getElementById('imggen-out');
  const count = parseInt(document.getElementById('imggen-count').value,10) || 1;
  if (!prompt) { putText(out, 'Please enter an image prompt.'); return; }
  putText(out, 'Generating…'); out.innerHTML='';
  try {
    const imgs = await puter.ai.txt2img(prompt, { count });
    if (Array.isArray(imgs)) {
      imgs.forEach(img => { img.classList.add('gen'); out.appendChild(img); });
    } else { imgs.classList.add('gen'); out.appendChild(imgs); }
  } catch (e) { putText(out, 'Error: ' + (e?.message ?? e)); }
});
</script>
</body>
</html>
