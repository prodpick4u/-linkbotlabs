<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>AI Demo - GPT-4.1 Nano</title>
  <script src="https://js.puter.com/v2/"></script>
  <style>
    body { font-family: Arial, sans-serif; background: #111; color: #eee; margin:0; padding:0;}
    header { background: #4b0082; padding: 15px; text-align: center; font-size: 18px; font-weight: bold;}
    #chat-container { max-width: 800px; margin: 20px auto; background: #1a1a2e; padding: 15px; border-radius: 10px;}
    #chat-out { border:1px solid #444; background:#000; min-height:200px; padding:10px; overflow-y:auto;}
    #chat-prompt { width:70%; padding:10px; border-radius:5px; border:none;}
    #chat-run { padding:10px 15px; border:none; border-radius:5px; background:#4b0082; color:#fff; cursor:pointer;}
    /* DEMO OVERLAY */
    #demo-overlay {
      display:none; position:fixed; top:0; left:0; right:0; bottom:0;
      background: rgba(0,0,0,0.95); color:#fff; z-index:1000;
      display:flex; align-items:center; justify-content:center; text-align:center;
      flex-direction:column; font-family: Arial, sans-serif;
    }
    #demo-overlay button {
      margin-top: 10px; padding:12px 20px; font-size:16px; border:none; border-radius:8px; cursor:pointer;
    }
    #pay-btn { background:#ff9900; }
    #close-btn { background:#444; }
  </style>
</head>
<body>
  <header>Free Demo: GPT-4.1 Nano Chat. Upgrade for full access!</header>

  <div id="chat-container">
    <select id="chat-model">
      <option value="gpt-4.1-nano">GPT-4.1-nano (fast & light)</option>
      <!-- Add other models if needed -->
    </select>
    <br><br>
    <textarea id="chat-prompt" placeholder="Type your message..."></textarea>
    <button id="chat-run">Run</button>
    <div id="chat-out"></div>
  </div>

  <!-- DEMO OVERLAY -->
  <div id="demo-overlay">
    <h1>Demo Expired</h1>
    <p>Your 5-minute demo has ended. Pay $12 via PayPal to continue.</p>
    <button id="pay-btn">Pay $12 & Continue</button>
    <button id="close-btn">Exit Demo</button>
  </div>

  <script>
    const chatOut = document.getElementById('chat-out');
    const chatPrompt = document.getElementById('chat-prompt');
    const chatRun = document.getElementById('chat-run');
    const chatModel = document.getElementById('chat-model');

    function putText(outEl, text) {
      outEl.innerHTML = text;
    }

    function normalizeNonStream(resp) {
      if(typeof resp==='string') return resp;
      if(resp.output) return resp.output;
      return JSON.stringify(resp);
    }

    // ---------- CHAT ----------
    chatRun.addEventListener('click', async () => {
      const model = chatModel.value;
      const prompt = chatPrompt.value.trim();
      if(!prompt) { putText(chatOut,'Please enter a prompt.'); return; }
      putText(chatOut,'Thinkingâ€¦');
      try {
        const resp = await puter.ai.chat(prompt, { model });
        putText(chatOut, normalizeNonStream(resp));
      } catch(e) {
        putText(chatOut, 'Error: ' + (e?.message ?? e));
      }
    });

    // ---------- 5-MINUTE DEMO TIMER ----------
    const demoDuration = 5 * 60 * 1000; // 5 minutes
    if (!localStorage.getItem('demoStart')) {
      localStorage.setItem('demoStart', Date.now());
    }
    const demoStart = parseInt(localStorage.getItem('demoStart'),10);
    const elapsed = Date.now() - demoStart;

    setTimeout(() => {
      const overlay = document.getElementById('demo-overlay');
      overlay.style.display = 'flex';
      // disable chat
      chatRun.disabled = true;
      chatPrompt.disabled = true;
    }, Math.max(0, demoDuration - elapsed));

    // Overlay buttons
    document.getElementById('pay-btn').addEventListener('click', () => {
      window.location.href = 'https://brave-morning-5979.puter.site/';
    });
    document.getElementById('close-btn').addEventListener('click', () => {
      const overlay = document.getElementById('demo-overlay');
      overlay.innerHTML = '<h2>Demo Ended</h2><p>Refresh to restart or pay to continue.</p>';
    });
  </script>
</body>
</html>
