<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>AI Playground</title>
<script src="https://js.puter.com/v2/"></script>
<style>
  :root { --glass: rgba(0,0,0,0.35); --stroke: rgba(255,255,255,0.12); --text:#fff; --muted:#cfcfcf; --accent:#ffe169; }
  * { box-sizing: border-box; }
  html, body { height: 100%; }
  body { margin:0; padding:24px; color:var(--text);
    background: radial-gradient(1200px 1200px at 10% -10%, #111 0%, #000 60%, #000 100%);
    font-family: system-ui, -apple-system, Segoe UI, Roboto, Inter, Arial, sans-serif;
  }
  h1 { margin:0 0 18px 0; font-weight:700; letter-spacing:.2px; }
  .grid { display:grid; grid-template-columns:repeat(12,1fr); gap:18px; }
  .card { grid-column:span 12; background:var(--glass); border:1px solid var(--stroke); border-radius:14px; padding:16px; backdrop-filter:blur(10px); -webkit-backdrop-filter:blur(10px); box-shadow:0 10px 30px rgba(0,0,0,.35); }
  @media(min-width:900px){.card{grid-column:span 6;}}
  label{display:block;font-size:12px;color:var(--muted);margin:8px 0 6px;}
  textarea,input,select{width:100%;color:var(--text);background:rgba(255,255,255,0.06);border:1px solid var(--stroke);border-radius:10px;padding:10px 12px;outline:none;caret-color:var(--text);}
  textarea{min-height:84px;resize:vertical;}
  button{display:inline-flex;align-items:center;gap:8px;background:var(--accent);color:#000;font-weight:700;border:0;border-radius:10px;padding:10px 14px;cursor:pointer;margin-top:10px;}
  .output{margin-top:12px;padding:12px;border-radius:10px;background:rgba(255,255,255,0.04);border:1px solid var(--stroke);white-space:pre-wrap;word-wrap:break-word;}
  img.gen{max-width:100%;height:auto;display:block;border-radius:10px;margin-top:10px;}
  .hint{font-size:12px;color:var(--muted);margin-top:6px;}

  /* --- Demo Splash --- */
  .splash {
    position:fixed; top:0; left:0; width:100%; height:100%;
    background:rgba(0,0,0,0.95); color:#fff; display:flex; flex-direction:column; align-items:center; justify-content:center; text-align:center;
    z-index:9999; padding:20px;
  }
</style>
</head>
<body>

<!-- DEMO SPLASH -->
<div id="demoSplash" class="splash">
  <h1>ðŸŽ‰ Welcome to Playground Demo</h1>
  <p>You have <b>60 minutes</b> of free AI playtime.</p>
  <button id="startDemoBtn">Start Exploring ðŸš€</button>
</div>

<h1>AI Playground</h1>
<div class="grid" id="playground" style="display:none;">

  <!-- CHAT / Q&A -->
  <div class="card" id="card-chat">
    <h2 style="margin:0 0 6px">Chat / Q&amp;A</h2>
    <div class="hint">Ask anything. Choose a chat model (includes <strong>GPT-4.1-nano</strong>).</div>
    <label for="chat-model">Model</label>
    <select id="chat-model">
      <option value="gpt-4.1-nano" selected>GPT-4.1-nano (fast & light)</option>
      <option value="gpt-4.1">GPT-4.1</option>
      <option value="gpt-4.1-mini">GPT-4.1-mini</option>
      <option value="gpt-4o">GPT-4o</option>
      <option value="gpt-4o-mini">GPT-4o-mini</option>
      <option value="gpt-5">GPT-5</option>
      <option value="gpt-5-mini">GPT-5-mini</option>
      <option value="gpt-5-nano">GPT-5-nano</option>
      <option value="gpt-5-chat-latest">GPT-5 chat (latest)</option>
    </select>
    <label for="chat-prompt">Prompt</label>
    <textarea id="chat-prompt" placeholder="e.g., Explain quantum computing in simple terms"></textarea>
    <button id="chat-run">Run</button>
    <div class="output" id="chat-out"></div>
  </div>

  <!-- IMAGE GENERATION -->
  <div class="card" id="card-imggen">
    <h2 style="margin:0 0 6px">Image Generation</h2>
    <div class="hint">Generate an image from text (DALLÂ·E via Puter.js).</div>
    <label for="imggen-model">Model</label>
    <select id="imggen-model"><option value="dalle">DALLÂ·E 3 (default)</option></select>
    <label for="imggen-prompt">Image Prompt</label>
    <textarea id="imggen-prompt" placeholder="e.g., A futuristic cityscape at night with neon rain"></textarea>
    <button id="imggen-run">Generate</button>
    <div class="output" id="imggen-out"></div>
  </div>

  <!-- IMAGE ANALYSIS -->
  <div class="card" id="card-vision">
    <h2 style="margin:0 0 6px">Image Analysis</h2>
    <div class="hint">Paste an image URL and ask a question about it.</div>
    <label for="vision-model">Model</label>
    <select id="vision-model">
      <option value="gpt-4o" selected>GPT-4o (vision)</option>
      <option value="gpt-4.1">GPT-4.1</option>
      <option value="gpt-4.1-nano">GPT-4.1-nano</option>
      <option value="gpt-5-nano">GPT-5-nano</option>
    </select>
    <label for="vision-url">Image URL</label>
    <input id="vision-url" placeholder="https://â€¦ (direct image link)" />
    <label for="vision-prompt">Prompt</label>
    <textarea id="vision-prompt">What do you see in this image?</textarea>
    <button id="vision-run">Analyze</button>
    <div class="output" id="vision-out"></div>
  </div>

  <!-- STREAMING LONG RESPONSES -->
  <div class="card" id="card-stream">
    <h2 style="margin:0 0 6px">Streaming (Long Responses)</h2>
    <div class="hint">See responses arrive in real-time.</div>
    <label for="stream-model">Model</label>
    <select id="stream-model">
      <option value="gpt-4.1-nano" selected>GPT-4.1-nano</option>
      <option value="gpt-4.1">GPT-4.1</option>
      <option value="gpt-4o">GPT-4o</option>
      <option value="gpt-5-nano">GPT-5-nano</option>
    </select>
    <label for="stream-prompt">Prompt</label>
    <textarea id="stream-prompt">Explain the theory of relativity in detail.</textarea>
    <button id="stream-run">Stream</button>
    <div class="output" id="stream-out"></div>
  </div>

</div>

<script>
/* --- Demo Splash & Timer --- */
let demoTime = 60*60*1000; // 1 hour
let demoStart;

document.addEventListener("DOMContentLoaded", () => {
  const startBtn = document.getElementById("startDemoBtn");
  startBtn?.addEventListener("click", () => {
    document.getElementById("demoSplash").style.display = "none";
    document.getElementById("playground").style.display = "grid";
    demoStart = Date.now();
    setInterval(() => {
      if (Date.now() - demoStart > demoTime) alert("Demo expired. Please refresh or donate to continue.");
    }, 10000);
  });
});

/* ---------- Helpers ---------- */
function putText(el,text){el.innerHTML=(text??'').toString();}
function appendText(el,text){el.innerHTML+=(text??'').toString();}
function normalizeNonStream(resp){if(typeof resp==='string')return resp;if(resp?.output_text)return resp.output_text;if(resp?.text)return resp.text;if(resp?.message?.content){if(Array.isArray(resp.message.content)){const first=resp.message.content[0];return typeof first==='string'?first:first?.text??JSON.stringify(resp.message.content);}return typeof resp.message.content==='string'?resp.message.content:JSON.stringify(resp.message.content);}return JSON.stringify(resp??{});}

/* ---------- CHAT ---------- */
document.getElementById('chat-run').addEventListener('click',async()=>{
  const model=document.getElementById('chat-model').value;
  const prompt=document.getElementById('chat-prompt').value.trim();
  const out=document.getElementById('chat-out');
  if(!prompt){putText(out,'Please enter a prompt.');return;}
  putText(out,'Thinkingâ€¦');
  try{const resp=await puter.ai.chat(prompt,{model});putText(out,normalizeNonStream(resp));}catch(e){putText(out,'Error: '+(e?.message??e));}
});

/* ---------- IMAGE GENERATION ---------- */
document.getElementById('imggen-run').addEventListener('click',async()=>{
  const prompt=document.getElementById('imggen-prompt').value.trim();
  const out=document.getElementById('imggen-out');
  if(!prompt){putText(out,'Please enter an image prompt.');return;}
  putText(out,'Generatingâ€¦'); out.innerHTML='';
  try{const imgEl=await puter.ai.txt2img(prompt);imgEl.classList.add('gen');out.appendChild(imgEl);}catch(e){putText(out,'Error: '+(e?.message??e));}
});

/* ---------- IMAGE ANALYSIS ---------- */
document.getElementById('vision-run').addEventListener('click',async()=>{
  const model=document.getElementById('vision-model').value;
  const url=document.getElementById('vision-url').value.trim();
  const prompt=document.getElementById('vision-prompt').value.trim();
  const out=document.getElementById('vision-out');
  if(!url){putText(out,'Please paste a direct image URL.');return;}
  if(!prompt){putText(out,'Please enter a prompt.');return;}
  putText(out,'Analyzing imageâ€¦');
  try{const resp=await puter.ai.chat(prompt,url,{model});putText(out,normalizeNonStream(resp));}catch(e){putText(out,'Error: '+(e?.message??e));}
});

/* ---------- STREAMING ---------- */
document.getElementById('stream-run').addEventListener('click',async()=>{
  const model=document.getElementById('stream-model').value;
  const prompt=document.getElementById('stream-prompt').value.trim();
  const out=document.getElementById('stream-out');
  if(!prompt){putText(out,'Please enter a prompt.');return;}
  putText(out,'');
  try{const stream=await puter.ai.chat(prompt,{model,stream:true});for await(const part of stream){if(part?.output_text)appendText(out,part.output_text.replaceAll('\n','<br>'));else if(part?.text)appendText(out,part.text.replaceAll('\n','<br>'));}}catch(e){putText(out,'Error: '+(e?.message??e));}
});
</script>

</body>
</html>
