<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>All Affiliate Products</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
<style>
body { font-family: 'Inter', sans-serif; margin: 0; background: #f0f2f5; }
h1 { text-align: center; margin-top: 30px; color: #222; font-weight: 600; }
.categories { display: flex; flex-wrap: wrap; justify-content: center; margin: 20px 0; gap: 12px; }
.category-card { padding: 12px 20px; background: #fff; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); cursor: pointer; transition: transform 0.2s, box-shadow 0.2s, background 0.2s, color 0.2s; font-weight: 500; display: flex; align-items: center; gap: 6px; }
.category-card:hover { transform: translateY(-3px); box-shadow: 0 6px 18px rgba(0,0,0,0.15); }
.category-card.active { background: #0073e6; color: #fff; }
.controls { display: flex; justify-content: center; margin-bottom: 20px; position: sticky; top: 0; background: #f0f2f5; padding: 10px 0; z-index: 100; }
#searchBox { padding: 10px 15px; border-radius: 8px; border: 1px solid #ccc; width: 280px; font-size: 14px; }
.grid { display: grid; grid-template-columns: repeat(auto-fill,minmax(280px,1fr)); gap: 20px; padding: 0 20px 40px; transition: all 0.3s ease; }
.card { background: #fff; border-radius: 12px; padding: 20px; box-shadow: 0 4px 12px rgba(0,0,0,0.08); display: flex; flex-direction: column; justify-content: space-between; transition: transform 0.2s, box-shadow 0.2s; }
.card:hover { transform: translateY(-5px); box-shadow: 0 10px 20px rgba(0,0,0,0.15); }
.product-title { font-weight: 600; font-size: 18px; color: #111; margin-bottom: 10px; }
.product-price { color: #ff5a5f; font-weight: bold; margin-bottom: 12px; }
.product-desc { font-size: 14px; color: #555; flex-grow: 1; }
.view-btn { margin-top: 15px; padding: 12px; background: #0073e6; color: #fff; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; text-align: center; text-decoration: none; transition: background 0.2s, transform 0.2s; }
.view-btn:hover { background: #005bb5; transform: translateY(-2px); }
@media(max-width:600px){.grid{grid-template-columns:1fr;}}
</style>
</head>
<body>

<h1>All Products</h1>
<div class="categories" id="category-container"></div>
<div class="controls">
  <input type="text" id="searchBox" placeholder="Search products...">
</div>
<div class="grid" id="product-container"></div>

<script>
const AFFILIATE_TAG = "mychanneld-20";
let PRODUCTS = {};
let currentCategory = 'all';
const CATEGORY_ICONS = {
  "all": "ðŸ“¦", "health": "ðŸ‹ï¸", "beauty": "ðŸ’„", "tech": "ðŸ’»", "kitchen": "ðŸ³", "outdoors": "ðŸ•ï¸", "household": "ðŸ ", "home-decor": "ðŸ–¼ï¸"
};

// ===== Fetch products.json =====
fetch('products.json')
  .then(res => res.json())
  .then(data => {
    PRODUCTS = data;
    populateCategories();
    displayProducts();
  });

// ===== Apply affiliate tag =====
function withTag(url) {
  return url.includes("?") ? `${url}&tag=${AFFILIATE_TAG}` : `${url}?tag=${AFFILIATE_TAG}`;
}

// ===== Display products =====
const productContainer = document.getElementById('product-container');
const searchBox = document.getElementById('searchBox');

function displayProducts(filterCategory = currentCategory, searchTerm = '') {
  productContainer.innerHTML = '';
  const allProducts = filterCategory === 'all' ? Object.values(PRODUCTS).flat() : PRODUCTS[filterCategory] || [];
  const filtered = allProducts.filter(p => p.title.toLowerCase().includes(searchTerm.toLowerCase()));
  filtered.forEach(product => {
    const card = document.createElement("div");
    card.className = "card";
    card.innerHTML = `
      <div class="product-title">${product.title}</div>
      <div class="product-price">${product.price}</div>
      <div class="product-desc">${product.description}</div>
      <a href="${withTag(product.url)}" target="_blank" class="view-btn">View Product</a>
    `;
    productContainer.appendChild(card);
  });
}

// ===== Populate categories =====
function populateCategories() {
  const categoryContainer = document.getElementById('category-container');
  const allCategories = ['all', ...Object.keys(PRODUCTS)];
  allCategories.forEach(cat => {
    const card = document.createElement('div');
    card.className = 'category-card' + (cat==='all'?' active':'');
    card.innerHTML = `${CATEGORY_ICONS[cat] || 'ðŸ“¦'} ${cat.charAt(0).toUpperCase() + cat.slice(1)}`;
    card.addEventListener('click', () => {
      currentCategory = cat;
      document.querySelectorAll('.category-card').forEach(c => c.classList.remove('active'));
      card.classList.add('active');
      displayProducts(currentCategory, searchBox.value);
    });
    categoryContainer.appendChild(card);
  });
}

// ===== Search products =====
searchBox.addEventListener('input', () => displayProducts(currentCategory, searchBox.value));
</script>

</body>
</html>
